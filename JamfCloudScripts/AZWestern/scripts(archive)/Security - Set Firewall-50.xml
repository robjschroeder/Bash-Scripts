<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<script>
    <id>50</id>
    <name>Security - Set Firewall</name>
    <category>Utilities</category>
    <filename>Security - Set Firewall</filename>
    <info></info>
    <notes></notes>
    <priority>After</priority>
    <parameters>
        <parameter4>GLOBAL_STATE</parameter4>
        <parameter5>ALLOWED_SIGNED</parameter5>
        <parameter6>BLOCK_ALL</parameter6>
        <parameter7>LOGGING_MODE</parameter7>
    </parameters>
    <os_requirements></os_requirements>
    <script_contents>#!/bin/bash

####################################################################################################
# Script tested with the following software
####################################################################################################
# macOS 10.9.x, 10.10.x, 10.11.x, 10.12.x, 10.13.x, 10.14.x, 10.15.x, 11
# DEPNotify 1.1.2, 1.1.3
# JAMF Pro 10.6 - 10.9

####################################################################################################
# Usage
####################################################################################################
# Enables the local firewall in macOS
# Launches DEPNotify with the jamf and fullscreen flags and executes onboarding policy
# Removes DEPNotify and support files after enrollment

####################################################################################################
# User experience variables - Modify as needed)
####################################################################################################
APP_FIREWALL="/usr/libexec/ApplicationFirewall/socketfilterfw"

GLOBAL_STATE="$4" # Set this variable in JAMF Pro to On | Off
ALLOWED_SIGNED="$5" # Set this variable in JAMF Pro to On | Off
BLOCK_ALL="$6" # Set this variable in JAMF Pro to On | Off
LOGGING_MODE="$7" # Set this variable in JAMF Pro to On | Off
 
####################################################################################################
# Script Logic
####################################################################################################
# Enable the firewall
"$APP_FIREWALL" --setglobalstate "$GLOBAL_STATE"

# Allow signed apps traffic
"$APP_FIREWALL" --setallowsigned "$ALLOWED_SIGNED"

# Block all incoming connections
"$APP_FIREWALL" --setblockall "$BLOCK_ALL"

# Set logging mode to 
"$APP_FIREWALL" --setloggingmode "$LOGGING_MODE"

exit 0</script_contents>
    <script_contents_encoded>IyEvYmluL2Jhc2gKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIyBTY3JpcHQgdGVzdGVkIHdpdGggdGhlIGZvbGxvd2luZyBzb2Z0d2FyZQojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMgbWFjT1MgMTAuOS54LCAxMC4xMC54LCAxMC4xMS54LCAxMC4xMi54LCAxMC4xMy54LCAxMC4xNC54LCAxMC4xNS54LCAxMQojIERFUE5vdGlmeSAxLjEuMiwgMS4xLjMKIyBKQU1GIFBybyAxMC42IC0gMTAuOQoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojIFVzYWdlCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIyBFbmFibGVzIHRoZSBsb2NhbCBmaXJld2FsbCBpbiBtYWNPUwojIExhdW5jaGVzIERFUE5vdGlmeSB3aXRoIHRoZSBqYW1mIGFuZCBmdWxsc2NyZWVuIGZsYWdzIGFuZCBleGVjdXRlcyBvbmJvYXJkaW5nIHBvbGljeQojIFJlbW92ZXMgREVQTm90aWZ5IGFuZCBzdXBwb3J0IGZpbGVzIGFmdGVyIGVucm9sbG1lbnQKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIyBVc2VyIGV4cGVyaWVuY2UgdmFyaWFibGVzIC0gTW9kaWZ5IGFzIG5lZWRlZCkKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwpBUFBfRklSRVdBTEw9Ii91c3IvbGliZXhlYy9BcHBsaWNhdGlvbkZpcmV3YWxsL3NvY2tldGZpbHRlcmZ3IgoKR0xPQkFMX1NUQVRFPSIkNCIgIyBTZXQgdGhpcyB2YXJpYWJsZSBpbiBKQU1GIFBybyB0byBPbiB8IE9mZgpBTExPV0VEX1NJR05FRD0iJDUiICMgU2V0IHRoaXMgdmFyaWFibGUgaW4gSkFNRiBQcm8gdG8gT24gfCBPZmYKQkxPQ0tfQUxMPSIkNiIgIyBTZXQgdGhpcyB2YXJpYWJsZSBpbiBKQU1GIFBybyB0byBPbiB8IE9mZgpMT0dHSU5HX01PREU9IiQ3IiAjIFNldCB0aGlzIHZhcmlhYmxlIGluIEpBTUYgUHJvIHRvIE9uIHwgT2ZmCiAKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojIFNjcmlwdCBMb2dpYwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMgRW5hYmxlIHRoZSBmaXJld2FsbAoiJEFQUF9GSVJFV0FMTCIgLS1zZXRnbG9iYWxzdGF0ZSAiJEdMT0JBTF9TVEFURSIKCiMgQWxsb3cgc2lnbmVkIGFwcHMgdHJhZmZpYwoiJEFQUF9GSVJFV0FMTCIgLS1zZXRhbGxvd3NpZ25lZCAiJEFMTE9XRURfU0lHTkVEIgoKIyBCbG9jayBhbGwgaW5jb21pbmcgY29ubmVjdGlvbnMKIiRBUFBfRklSRVdBTEwiIC0tc2V0YmxvY2thbGwgIiRCTE9DS19BTEwiCgojIFNldCBsb2dnaW5nIG1vZGUgdG8gCiIkQVBQX0ZJUkVXQUxMIiAtLXNldGxvZ2dpbmdtb2RlICIkTE9HR0lOR19NT0RFIgoKZXhpdCAw</script_contents_encoded>
</script>