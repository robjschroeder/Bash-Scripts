<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<script>
    <id>29</id>
    <name>Applications - Microsoft Auto Update</name>
    <category>Productivity</category>
    <filename>Applications - Microsoft Auto Update</filename>
    <info></info>
    <notes></notes>
    <priority>After</priority>
    <parameters></parameters>
    <os_requirements></os_requirements>
    <script_contents>#!/bin/sh
#
# Microsoft AutoUpdate Helper for Jamf Pro
# Script Version 1.4
#
## Copyright (c) 2018 Microsoft Corp. All rights reserved.
## Scripts are not supported under any Microsoft standard support program or service. The scripts are provided AS IS without warranty of any kind.
## Microsoft disclaims all implied warranties including, without limitation, any implied warranties of merchantability or of fitness for a 
## particular purpose. The entire risk arising out of the use or performance of the scripts and documentation remains with you. In no event shall
## Microsoft, its authors, or anyone else involved in the creation, production, or delivery of the scripts be liable for any damages whatsoever 
## (including, without limitation, damages for loss of business profits, business interruption, loss of business information, or other pecuniary 
## loss) arising out of the use of or inability to use the sample scripts or documentation, even if Microsoft has been advised of the possibility
## of such damages.
## Feedback: pbowden@microsoft.com 

# IT Admin constants for which applications to update [set to true or false as required]
UPDATE_WORD="true"
UPDATE_EXCEL="true"
UPDATE_POWERPOINT="true"
UPDATE_OUTLOOK="true"
UPDATE_ONENOTE="true"
UPDATE_SKYPEBUSINESS="true"
UPDATE_REMOTEDESKTOP="true"
UPDATE_COMPANYPORTAL="true"
UPDATE_TEAMS="true"
UPDATE_ONEDRIVE="true"
UDPATE_MAU="true"

# IT Admin constants for application target version [set to "latest" to get latest update, or specific build number, such as "15.41.17120500"]
VERSION_WORD="latest"
VERSION_EXCEL="latest"
VERSION_POWERPOINT="latest"
VERSION_OUTLOOK="latest"
VERSION_ONENOTE="latest"
VERSION_SKYPEBUSINESS="latest"
VERSION_REMOTEDESKTOP="latest"
VERSION_COMPANYPORTAL="latest"
VERSION_TEAMS="latest"
VERSION_ONEDRIVE="latest"
VERSION_MAU="latest"

# IT Admin constants for application path
PATH_WORD="/Applications/Microsoft Word.app"
PATH_EXCEL="/Applications/Microsoft Excel.app"
PATH_POWERPOINT="/Applications/Microsoft PowerPoint.app"
PATH_OUTLOOK="/Applications/Microsoft Outlook.app"
PATH_ONENOTE="/Applications/Microsoft OneNote.app"
PATH_SKYPEBUSINESS="/Applications/Skype for Business.app"
PATH_REMOTEDESKTOP="/Applications/Microsoft Remote Desktop.app"
PATH_COMPANYPORTAL="/Applications/Company Portal.app"
PATH_TEAMS="/Applications/Microsoft Teams.app"
PATH_ONEDRIVE="/Applications/OneDrive.app"
PATH_MAU="/Library/Application Support/Microsoft/MAU2.0/Microsoft AutoUpdate.app"

# Function to enable debug logging
function Debug() {
    if [ "$OVERRIDE_DEBUG" == "true" ] || [ "$OVERRIDE_DEBUG" == "TRUE" ] || [ "$OVERRIDE_DEBUG" == "True" ] || [ "$OVERRIDE_DEBUG" == "YES" ] || [ "$OVERRIDE_DEBUG" == "yes" ] || [ "$OVERRIDE_DEBUG" == "Yes" ]; then
        LOG=$(date; echo "$1")
        echo "$LOG"
    fi
}

# Harvest script parameter overrides
OVERRIDE_DEBUG="$4"
OVERRIDE_WORD="$5"
Debug "OVERRIDE_WORD: $5"
OVERRIDE_EXCEL="$6"
Debug "OVERRIDE_EXCEL: $6"
OVERRIDE_POWERPOINT="$7"
Debug "OVERRIDE_POWERPOINT: $7"
OVERRIDE_OUTLOOK="$8"
Debug "OVERRIDE_OUTLOOK: $8"
OVERRIDE_SKYPEBUSINESS="$9"
Debug "OVERRIDE_SKYPEBUSINESS: $9"
OVERRIDE_ONENOTE="${10}"
Debug "OVERRIDE_ONENOTE: ${10}"
OVERRIDE_REMOTEDESKTOP="${11}"
Debug "OVERRIDE_REMOTEDESKTOP: ${11}"
OVERRIDE_TEAMS="${12}"
Debug "OVERRIDE_TEAMS: ${12}"
OVERRIDE_ONEDRIVE="${13}"
Debug "OVERRIDE_ONEDRIVE: ${13}"
OVERRIDE_MAU="${14}"
Debug "OVERRIDE_MAU: ${14}"


# Function to evaluate app update override
function GetUpdateOverride() {
    if [ ! "$1" = "" ]; then
        local UPDATE_FIELD1=$(echo "$1" | cut -d '@' -f1)
        if [ "$UPDATE_FIELD1" == "TRUE" ] || [ "$UPDATE_FIELD1" == "true" ] || [ "$UPDATE_FIELD1" == "True" ] || [ "$UPDATE_FIELD1" == "YES" ] || [ "$UPDATE_FIELD1" == "yes" ] || [ "$UPDATE_FIELD1" == "Yes" ]; then
            echo "true"
        elif [ "$UPDATE_FIELD1" == "FALSE" ] || [ "$UPDATE_FIELD1" == "false" ] || [ "$UPDATE_FIELD1" == "False" ] || [ "$UPDATE_FIELD1" == "NO" ] || [ "$UPDATE_FIELD1" == "no" ] || [ "$UPDATE_FIELD1" == "No" ]; then
            echo "false"
        fi
    else
        echo "$2"
    fi
}

# Function to evaluate app version override
function GetVersionOverride() {
    if [ ! "$1" = "" ]; then
        local UPDATE_FIELD2=$(echo "$1" | cut -d '@' -f2)
        if [ "$UPDATE_FIELD2" == "TRUE" ] || [ "$UPDATE_FIELD2" == "true" ]  || [ "$UPDATE_FIELD2" == "True" ] || [ "$UPDATE_FIELD2" == "YES" ] || [ "$UPDATE_FIELD2" == "yes" ]  || [ "$UPDATE_FIELD2" == "Yes" ] || [ "$UPDATE_FIELD2" == "FALSE" ] || [ "$UPDATE_FIELD2" == "false" ] || [ "$UPDATE_FIELD2" == "False" ]  || [ "$UPDATE_FIELD2" == "NO" ] || [ "$UPDATE_FIELD2" == "no" ] || [ "$UPDATE_FIELD2" == "No" ] ; then
            echo "$2"
        else
            echo "$UPDATE_FIELD2"
        fi
    else
        echo "$2"
    fi
}

# Function to parse script parameter overrides
function GetOverrides() {
    UPDATE_WORD=$(GetUpdateOverride "$OVERRIDE_WORD" "$UPDATE_WORD")
    Debug "Resolved UPDATE_WORD: $UPDATE_WORD"
    VERSION_WORD=$(GetVersionOverride "$OVERRIDE_WORD" "$VERSION_WORD")
    Debug "Resolved VERSION_WORD: $VERSION_WORD"

    UPDATE_EXCEL=$(GetUpdateOverride "$OVERRIDE_EXCEL" "$UPDATE_EXCEL")
    Debug "Resolved UPDATE_EXCEL: $UPDATE_EXCEL"
    VERSION_EXCEL=$(GetVersionOverride "$OVERRIDE_EXCEL" "$VERSION_EXCEL")
    Debug "Resolved VERSION_EXCEL: $VERSION_EXCEL"

    UPDATE_POWERPOINT=$(GetUpdateOverride "$OVERRIDE_POWERPOINT" "$UPDATE_POWERPOINT")
    Debug "Resolved UPDATE_POWERPOINT: $UPDATE_POWERPOINT"
    VERSION_POWERPOINT=$(GetVersionOverride "$OVERRIDE_POWERPOINT" "$VERSION_POWERPOINT")
    Debug "Resolved VERSION_POWERPOINT: $VERSION_POWERPOINT"

    UPDATE_OUTLOOK=$(GetUpdateOverride "$OVERRIDE_OUTLOOK" "$UPDATE_OUTLOOK")
    Debug "Resolved UPDATE_OUTLOOK: $UPDATE_OUTLOOK"
    VERSION_OUTLOOK=$(GetVersionOverride "$OVERRIDE_OUTLOOK" "$VERSION_OUTLOOK")
    Debug "Resolved VERSION_OUTLOOK: $VERSION_OUTLOOK"

    UPDATE_SKYPEBUSINESS=$(GetUpdateOverride "$OVERRIDE_SKYPEBUSINESS" "$UPDATE_SKYPEBUSINESS")
    Debug "Resolved UPDATE_SKYPEBUSINESS: $UPDATE_SKYPEBUSINESS"
    VERSION_SKYPEBUSINESS=$(GetVersionOverride "$OVERRIDE_SKYPEBUSINESS" "$VERSION_SKYPEBUSINESS")
    Debug "Resolved VERSION_SKYPEBUSINESS: $VERSION_SKYPEBUSINESS"

    UPDATE_ONENOTE=$(GetUpdateOverride "$OVERRIDE_ONENOTE" "$UPDATE_ONENOTE")
    Debug "Resolved UPDATE_ONENOTE: $UPDATE_ONENOTE"
    VERSION_ONENOTE=$(GetVersionOverride "$OVERRIDE_ONENOTE" "$VERSION_ONENOTE")
    Debug "Resolved VERSION_ONENOTE: $VERSION_ONENOTE"

    UPDATE_REMOTEDESKTOP=$(GetUpdateOverride "$OVERRIDE_REMOTEDESKTOP" "$UPDATE_REMOTEDESKTOP")
    Debug "Resolved UPDATE_REMOTEDESKTOP: $UPDATE_REMOTEDESKTOP"
    VERSION_REMOTEDESKTOP=$(GetVersionOverride "$OVERRIDE_REMOTEDESKTOP" "$VERSION_REMOTEDESKTOP")
    Debug "Resolved VERSION_REMOTEDESKTOP: $VERSION_REMOTEDESKTOP"
    
    UPDATE_TEAMS=$(GetUpdateOverride "$OVERRIDE_TEAMS" "$UPDATE_TEAMS")
    Debug "Resolved UPDATE_TEAMS: $UPDATE_TEAMS"
    VERSION_TEAMS=$(GetVersionOverride "$OVERRIDE_TEAMS" "$VERSION_TEAMS")
    Debug "Resolved VERSION_TEAMS: $VERSION_TEAMS"
    
    UPDATE_ONEDRIVE=$(GetUpdateOverride "$OVERRIDE_ONEDRIVE" "$UPDATE_ONEDRIVE")
    Debug "Resolved UPDATE_ONEDRIVE: $UPDATE_ONEDRIVE"
    VERSION_ONEDRIVE=$(GetVersionOverride "$OVERRIDE_ONEDRIVE" "$VERSION_ONEDRIVE")
    Debug "Resolved VERSION_ONEDRIVE: $VERSION_ONEDRIVE"
    
    UPDATE_MAU=$(GetUpdateOverride "$OVERRIDE_MAU" "$UPDATE_MAU")
    Debug "Resolved UPDATE_MAU: $UPDATE_MAU"
    VERSION_MAU=$(GetVersionOverride "$OVERRIDE_MAU" "$VERSION_MAU")
    Debug "Resolved VERSION_MAU: $VERSION_MAU"
}

# Function to check whether MAU 3.18 or later command-line updates are available
function CheckMAUInstall() {
    if [ ! -e "/Library/Application Support/Microsoft/MAU2.0/Microsoft AutoUpdate.app/Contents/MacOS/msupdate" ]; then
        echo "MAU 3.18 or later is required!"
        exit 1
    fi
}

# Function to check whether Office apps are installed
function CheckAppInstall() {
    if [ ! -e "$PATH_WORD" ]; then
        Debug "Word is not installed"
        UPDATE_WORD="false"
    fi
    if [ ! -e "$PATH_EXCEL" ]; then
        Debug "Excel is not installed"
        UPDATE_EXCEL="false"
    fi
    if [ ! -e "$PATH_POWERPOINT" ]; then
        Debug "PowerPoint is not installed"
        UPDATE_POWERPOINT="false"
    fi
    if [ ! -e "$PATH_OUTLOOK" ]; then
        Debug "Outlook is not installed"
        UPDATE_OUTLOOK="false"
    fi
    if [ ! -e "$PATH_ONENOTE" ]; then
        Debug "OneNote is not installed"
        UPDATE_ONENOTE="false"
    fi
    if [ ! -e "$PATH_SKYPEBUSINESS" ]; then
        Debug "Skype for Business is not installed"
        UPDATE_SKYPEBUSINESS="false"
    fi
    if [ ! -e "$PATH_REMOTEDESKTOP" ]; then
        Debug "Remote Desktop is not installed"
        UPDATE_REMOTEDESKTOP="false"
    fi
    if [ ! -e "$PATH_COMPANYPORTAL" ]; then
        Debug "Company Portal is not installed"
        UPDATE_COMPANYPORTAL="false"
    fi
    if [ ! -e "$PATH_TEAMS" ]; then
        Debug "Teams is not installed"
        UPDATE_TEAMS="false"
    fi
    if [ ! -e "$PATH_ONEDRIVE" ]; then
        Debug "OneDrive is not installed"
        UPDATE_ONEDRIVE="false"
    fi
    if [ ! -e "$PATH_MAU" ]; then
        Debug "MAU is not installed"
        UPDATE_MAU="false"
    fi
    
}

# Function to determine the logged-in state of the Mac
function DetermineLoginState() {
    # The following line is courtesy of @macmule - https://macmule.com/2014/11/19/how-to-get-the-currently-logged-in-user-in-a-more-apple-approved-way/
    CONSOLE=$(/usr/bin/python -c 'from SystemConfiguration import SCDynamicStoreCopyConsoleUser; import sys; username = (SCDynamicStoreCopyConsoleUser(None, None, None) or [None])[0]; username = [username,""][username in [u"loginwindow", None, u""]]; sys.stdout.write(username + "\n");')
    if [ "$CONSOLE" == "" ]; then
        echo "No user logged in"
        CMD_PREFIX=""
    else
        echo "User $CONSOLE is logged in"
        CMD_PREFIX="sudo -u $CONSOLE "
    fi
    Debug "Resolved CMD_PREFIX: $CMD_PREFIX"
}

# Function to set target version for app
function SetTargetVersion() {
    if [ "$1" == "LATEST" ] || [ "$1" == "latest" ] || [ "$1" == "" ]; then
        TARGET_VERSION=""
    else
        TARGET_VERSION="--version ${1}"
    fi
    Debug "Final TARGET_VERSION: $TARGET_VERSION"
}

# Function to register an application with MAU
function RegisterApp() {
    Debug "RegisterApp: Params - $1 $2"
    $(${CMD_PREFIX}defaults write com.microsoft.autoupdate2 Applications -dict-add "$1" "{ 'Application ID' = '$2'; LCID = 1033 ; }")
}

# Function to call 'msupdate' and update the target application
function PerformUpdate() {
    Debug "PerformUpdate: ${CMD_PREFIX}/Library/Application\ Support/Microsoft/MAU2.0/Microsoft\ AutoUpdate.app/Contents/MacOS/msupdate --install --apps $1 $2 --wait 600 2&gt;/dev/null"
    ${CMD_PREFIX}/Library/Application\ Support/Microsoft/MAU2.0/Microsoft\ AutoUpdate.app/Contents/MacOS/msupdate --install --apps $1 $2 --wait 600 2&gt;/dev/null
}

## MAIN
CheckMAUInstall
GetOverrides
CheckAppInstall
DetermineLoginState

if [ "$UPDATE_WORD" == "true" ]; then
    Debug "Going for Word update"
    RegisterApp "$PATH_WORD" "MSWD2019"
    SetTargetVersion "$VERSION_WORD"
    PerformUpdate "MSWD2019" "$TARGET_VERSION"
else
    Debug "Update for Word disabled"
fi
if [ "$UPDATE_EXCEL" == "true" ]; then
    Debug "Going for Excel update"
    RegisterApp "$PATH_EXCEL" "XCEL2019"
    SetTargetVersion "$VERSION_EXCEL"
    PerformUpdate "XCEL2019" "$TARGET_VERSION"
else
    Debug "Update for Excel disabled"
fi
if [ "$UPDATE_POWERPOINT" == "true" ]; then
    Debug "Going for PowerPoint update"
    RegisterApp "$PATH_POWERPOINT" "PPT32019"
    SetTargetVersion "$VERSION_POWERPOINT"
    PerformUpdate "PPT32019" "$TARGET_VERSION"
else
    Debug "Update for PowerPoint disabled"
fi
if [ "$UPDATE_OUTLOOK" == "true" ]; then
    Debug "Going for Outlook update"
    RegisterApp "$PATH_OUTLOOK" "OPIM2019"
    SetTargetVersion "$VERSION_OUTLOOK"
    PerformUpdate "OPIM2019" "$TARGET_VERSION"
else
    Debug "Update for Outlook disabled"
fi
if [ "$UPDATE_ONENOTE" == "true" ]; then
    Debug "Going for OneNote update"
    RegisterApp "$PATH_ONENOTE" "ONMC2019"
    SetTargetVersion "$VERSION_ONENOTE"
    PerformUpdate "ONMC2019" "$TARGET_VERSION"
else
    Debug "Update for OneNote disabled"
fi
if [ "$UPDATE_SKYPEBUSINESS" == "true" ]; then
    Debug "Going for SfB update"
    RegisterApp "$PATH_SKYPEBUSINESS" "MSFB16"
    SetTargetVersion "$VERSION_SKYPEBUSINESS"
    PerformUpdate "MSFB16" "$TARGET_VERSION"
else
    Debug "Update for SfB disabled"
fi
if [ "$UPDATE_REMOTEDESKTOP" == "true" ]; then
    Debug "Going for Remote Desktop update"
    RegisterApp "$PATH_REMOTEDESKTOP" "MSRD10"
    SetTargetVersion "$VERSION_REMOTEDESKTOP"
    PerformUpdate "MSRD10" "$TARGET_VERSION"
else
    Debug "Update for Remote Desktop disabled"
fi
if [ "$UPDATE_COMPANYPORTAL" == "true" ]; then
    Debug "Going for Company Portal update"
    RegisterApp "$PATH_COMPANYPORTAL" "IMCP01"
    SetTargetVersion "$VERSION_COMPANYPORTAL"
    PerformUpdate "IMCP01" "$TARGET_VERSION"
else
    Debug "Update for Company Portal disabled"
fi
if [ "$UPDATE_MAU" == "true" ]; then
    Debug "Going for Microsot Auto Updater update"
    RegisterApp "$UPDATE_MAU" "MSau04"
    SetTargetVersion "$VERSION_MAU"
    PerformUpdate "MSau04" "$TARGET_VERSION"
else
    Debug "Update for Microsoft Auto Updater disabled"
fi
if [ "$UPDATE_ONEDRIVE" == "true" ]; then
    Debug "Going for OneDrive update"
    RegisterApp "$PATH_ONEDRIVE" "ONDR18"
    SetTargetVersion "$VERSION_ONEDRIVE"
    PerformUpdate "ONDR18" "$TARGET_VERSION"
else
    Debug "Update for OneDrive disabled"
fi
if [ "$UPDATE_TEAMS" == "true" ]; then
    Debug "Going for Teams update"
    RegisterApp "$PATH_TEAMS" "TEAM01"
    SetTargetVersion "$VERSION_TEAMS"
    PerformUpdate "TEAM01" "$TARGET_VERSION"
else
    Debug "Update for Teams disabled"
fi

exit 0</script_contents>
    <script_contents_encoded>IyEvYmluL3NoCiMKIyBNaWNyb3NvZnQgQXV0b1VwZGF0ZSBIZWxwZXIgZm9yIEphbWYgUHJvCiMgU2NyaXB0IFZlcnNpb24gMS40CiMKIyMgQ29weXJpZ2h0IChjKSAyMDE4IE1pY3Jvc29mdCBDb3JwLiBBbGwgcmlnaHRzIHJlc2VydmVkLgojIyBTY3JpcHRzIGFyZSBub3Qgc3VwcG9ydGVkIHVuZGVyIGFueSBNaWNyb3NvZnQgc3RhbmRhcmQgc3VwcG9ydCBwcm9ncmFtIG9yIHNlcnZpY2UuIFRoZSBzY3JpcHRzIGFyZSBwcm92aWRlZCBBUyBJUyB3aXRob3V0IHdhcnJhbnR5IG9mIGFueSBraW5kLgojIyBNaWNyb3NvZnQgZGlzY2xhaW1zIGFsbCBpbXBsaWVkIHdhcnJhbnRpZXMgaW5jbHVkaW5nLCB3aXRob3V0IGxpbWl0YXRpb24sIGFueSBpbXBsaWVkIHdhcnJhbnRpZXMgb2YgbWVyY2hhbnRhYmlsaXR5IG9yIG9mIGZpdG5lc3MgZm9yIGEgCiMjIHBhcnRpY3VsYXIgcHVycG9zZS4gVGhlIGVudGlyZSByaXNrIGFyaXNpbmcgb3V0IG9mIHRoZSB1c2Ugb3IgcGVyZm9ybWFuY2Ugb2YgdGhlIHNjcmlwdHMgYW5kIGRvY3VtZW50YXRpb24gcmVtYWlucyB3aXRoIHlvdS4gSW4gbm8gZXZlbnQgc2hhbGwKIyMgTWljcm9zb2Z0LCBpdHMgYXV0aG9ycywgb3IgYW55b25lIGVsc2UgaW52b2x2ZWQgaW4gdGhlIGNyZWF0aW9uLCBwcm9kdWN0aW9uLCBvciBkZWxpdmVyeSBvZiB0aGUgc2NyaXB0cyBiZSBsaWFibGUgZm9yIGFueSBkYW1hZ2VzIHdoYXRzb2V2ZXIgCiMjIChpbmNsdWRpbmcsIHdpdGhvdXQgbGltaXRhdGlvbiwgZGFtYWdlcyBmb3IgbG9zcyBvZiBidXNpbmVzcyBwcm9maXRzLCBidXNpbmVzcyBpbnRlcnJ1cHRpb24sIGxvc3Mgb2YgYnVzaW5lc3MgaW5mb3JtYXRpb24sIG9yIG90aGVyIHBlY3VuaWFyeSAKIyMgbG9zcykgYXJpc2luZyBvdXQgb2YgdGhlIHVzZSBvZiBvciBpbmFiaWxpdHkgdG8gdXNlIHRoZSBzYW1wbGUgc2NyaXB0cyBvciBkb2N1bWVudGF0aW9uLCBldmVuIGlmIE1pY3Jvc29mdCBoYXMgYmVlbiBhZHZpc2VkIG9mIHRoZSBwb3NzaWJpbGl0eQojIyBvZiBzdWNoIGRhbWFnZXMuCiMjIEZlZWRiYWNrOiBwYm93ZGVuQG1pY3Jvc29mdC5jb20gCgojIElUIEFkbWluIGNvbnN0YW50cyBmb3Igd2hpY2ggYXBwbGljYXRpb25zIHRvIHVwZGF0ZSBbc2V0IHRvIHRydWUgb3IgZmFsc2UgYXMgcmVxdWlyZWRdClVQREFURV9XT1JEPSJ0cnVlIgpVUERBVEVfRVhDRUw9InRydWUiClVQREFURV9QT1dFUlBPSU5UPSJ0cnVlIgpVUERBVEVfT1VUTE9PSz0idHJ1ZSIKVVBEQVRFX09ORU5PVEU9InRydWUiClVQREFURV9TS1lQRUJVU0lORVNTPSJ0cnVlIgpVUERBVEVfUkVNT1RFREVTS1RPUD0idHJ1ZSIKVVBEQVRFX0NPTVBBTllQT1JUQUw9InRydWUiClVQREFURV9URUFNUz0idHJ1ZSIKVVBEQVRFX09ORURSSVZFPSJ0cnVlIgpVRFBBVEVfTUFVPSJ0cnVlIgoKIyBJVCBBZG1pbiBjb25zdGFudHMgZm9yIGFwcGxpY2F0aW9uIHRhcmdldCB2ZXJzaW9uIFtzZXQgdG8gImxhdGVzdCIgdG8gZ2V0IGxhdGVzdCB1cGRhdGUsIG9yIHNwZWNpZmljIGJ1aWxkIG51bWJlciwgc3VjaCBhcyAiMTUuNDEuMTcxMjA1MDAiXQpWRVJTSU9OX1dPUkQ9ImxhdGVzdCIKVkVSU0lPTl9FWENFTD0ibGF0ZXN0IgpWRVJTSU9OX1BPV0VSUE9JTlQ9ImxhdGVzdCIKVkVSU0lPTl9PVVRMT09LPSJsYXRlc3QiClZFUlNJT05fT05FTk9URT0ibGF0ZXN0IgpWRVJTSU9OX1NLWVBFQlVTSU5FU1M9ImxhdGVzdCIKVkVSU0lPTl9SRU1PVEVERVNLVE9QPSJsYXRlc3QiClZFUlNJT05fQ09NUEFOWVBPUlRBTD0ibGF0ZXN0IgpWRVJTSU9OX1RFQU1TPSJsYXRlc3QiClZFUlNJT05fT05FRFJJVkU9ImxhdGVzdCIKVkVSU0lPTl9NQVU9ImxhdGVzdCIKCiMgSVQgQWRtaW4gY29uc3RhbnRzIGZvciBhcHBsaWNhdGlvbiBwYXRoClBBVEhfV09SRD0iL0FwcGxpY2F0aW9ucy9NaWNyb3NvZnQgV29yZC5hcHAiClBBVEhfRVhDRUw9Ii9BcHBsaWNhdGlvbnMvTWljcm9zb2Z0IEV4Y2VsLmFwcCIKUEFUSF9QT1dFUlBPSU5UPSIvQXBwbGljYXRpb25zL01pY3Jvc29mdCBQb3dlclBvaW50LmFwcCIKUEFUSF9PVVRMT09LPSIvQXBwbGljYXRpb25zL01pY3Jvc29mdCBPdXRsb29rLmFwcCIKUEFUSF9PTkVOT1RFPSIvQXBwbGljYXRpb25zL01pY3Jvc29mdCBPbmVOb3RlLmFwcCIKUEFUSF9TS1lQRUJVU0lORVNTPSIvQXBwbGljYXRpb25zL1NreXBlIGZvciBCdXNpbmVzcy5hcHAiClBBVEhfUkVNT1RFREVTS1RPUD0iL0FwcGxpY2F0aW9ucy9NaWNyb3NvZnQgUmVtb3RlIERlc2t0b3AuYXBwIgpQQVRIX0NPTVBBTllQT1JUQUw9Ii9BcHBsaWNhdGlvbnMvQ29tcGFueSBQb3J0YWwuYXBwIgpQQVRIX1RFQU1TPSIvQXBwbGljYXRpb25zL01pY3Jvc29mdCBUZWFtcy5hcHAiClBBVEhfT05FRFJJVkU9Ii9BcHBsaWNhdGlvbnMvT25lRHJpdmUuYXBwIgpQQVRIX01BVT0iL0xpYnJhcnkvQXBwbGljYXRpb24gU3VwcG9ydC9NaWNyb3NvZnQvTUFVMi4wL01pY3Jvc29mdCBBdXRvVXBkYXRlLmFwcCIKCiMgRnVuY3Rpb24gdG8gZW5hYmxlIGRlYnVnIGxvZ2dpbmcKZnVuY3Rpb24gRGVidWcoKSB7CiAgICBpZiBbICIkT1ZFUlJJREVfREVCVUciID09ICJ0cnVlIiBdIHx8IFsgIiRPVkVSUklERV9ERUJVRyIgPT0gIlRSVUUiIF0gfHwgWyAiJE9WRVJSSURFX0RFQlVHIiA9PSAiVHJ1ZSIgXSB8fCBbICIkT1ZFUlJJREVfREVCVUciID09ICJZRVMiIF0gfHwgWyAiJE9WRVJSSURFX0RFQlVHIiA9PSAieWVzIiBdIHx8IFsgIiRPVkVSUklERV9ERUJVRyIgPT0gIlllcyIgXTsgdGhlbgogICAgICAgIExPRz0kKGRhdGU7IGVjaG8gIiQxIikKICAgICAgICBlY2hvICIkTE9HIgogICAgZmkKfQoKIyBIYXJ2ZXN0IHNjcmlwdCBwYXJhbWV0ZXIgb3ZlcnJpZGVzCk9WRVJSSURFX0RFQlVHPSIkNCIKT1ZFUlJJREVfV09SRD0iJDUiCkRlYnVnICJPVkVSUklERV9XT1JEOiAkNSIKT1ZFUlJJREVfRVhDRUw9IiQ2IgpEZWJ1ZyAiT1ZFUlJJREVfRVhDRUw6ICQ2IgpPVkVSUklERV9QT1dFUlBPSU5UPSIkNyIKRGVidWcgIk9WRVJSSURFX1BPV0VSUE9JTlQ6ICQ3IgpPVkVSUklERV9PVVRMT09LPSIkOCIKRGVidWcgIk9WRVJSSURFX09VVExPT0s6ICQ4IgpPVkVSUklERV9TS1lQRUJVU0lORVNTPSIkOSIKRGVidWcgIk9WRVJSSURFX1NLWVBFQlVTSU5FU1M6ICQ5IgpPVkVSUklERV9PTkVOT1RFPSIkezEwfSIKRGVidWcgIk9WRVJSSURFX09ORU5PVEU6ICR7MTB9IgpPVkVSUklERV9SRU1PVEVERVNLVE9QPSIkezExfSIKRGVidWcgIk9WRVJSSURFX1JFTU9URURFU0tUT1A6ICR7MTF9IgpPVkVSUklERV9URUFNUz0iJHsxMn0iCkRlYnVnICJPVkVSUklERV9URUFNUzogJHsxMn0iCk9WRVJSSURFX09ORURSSVZFPSIkezEzfSIKRGVidWcgIk9WRVJSSURFX09ORURSSVZFOiAkezEzfSIKT1ZFUlJJREVfTUFVPSIkezE0fSIKRGVidWcgIk9WRVJSSURFX01BVTogJHsxNH0iCgoKIyBGdW5jdGlvbiB0byBldmFsdWF0ZSBhcHAgdXBkYXRlIG92ZXJyaWRlCmZ1bmN0aW9uIEdldFVwZGF0ZU92ZXJyaWRlKCkgewogICAgaWYgWyAhICIkMSIgPSAiIiBdOyB0aGVuCiAgICAgICAgbG9jYWwgVVBEQVRFX0ZJRUxEMT0kKGVjaG8gIiQxIiB8IGN1dCAtZCAnQCcgLWYxKQogICAgICAgIGlmIFsgIiRVUERBVEVfRklFTEQxIiA9PSAiVFJVRSIgXSB8fCBbICIkVVBEQVRFX0ZJRUxEMSIgPT0gInRydWUiIF0gfHwgWyAiJFVQREFURV9GSUVMRDEiID09ICJUcnVlIiBdIHx8IFsgIiRVUERBVEVfRklFTEQxIiA9PSAiWUVTIiBdIHx8IFsgIiRVUERBVEVfRklFTEQxIiA9PSAieWVzIiBdIHx8IFsgIiRVUERBVEVfRklFTEQxIiA9PSAiWWVzIiBdOyB0aGVuCiAgICAgICAgICAgIGVjaG8gInRydWUiCiAgICAgICAgZWxpZiBbICIkVVBEQVRFX0ZJRUxEMSIgPT0gIkZBTFNFIiBdIHx8IFsgIiRVUERBVEVfRklFTEQxIiA9PSAiZmFsc2UiIF0gfHwgWyAiJFVQREFURV9GSUVMRDEiID09ICJGYWxzZSIgXSB8fCBbICIkVVBEQVRFX0ZJRUxEMSIgPT0gIk5PIiBdIHx8IFsgIiRVUERBVEVfRklFTEQxIiA9PSAibm8iIF0gfHwgWyAiJFVQREFURV9GSUVMRDEiID09ICJObyIgXTsgdGhlbgogICAgICAgICAgICBlY2hvICJmYWxzZSIKICAgICAgICBmaQogICAgZWxzZQogICAgICAgIGVjaG8gIiQyIgogICAgZmkKfQoKIyBGdW5jdGlvbiB0byBldmFsdWF0ZSBhcHAgdmVyc2lvbiBvdmVycmlkZQpmdW5jdGlvbiBHZXRWZXJzaW9uT3ZlcnJpZGUoKSB7CiAgICBpZiBbICEgIiQxIiA9ICIiIF07IHRoZW4KICAgICAgICBsb2NhbCBVUERBVEVfRklFTEQyPSQoZWNobyAiJDEiIHwgY3V0IC1kICdAJyAtZjIpCiAgICAgICAgaWYgWyAiJFVQREFURV9GSUVMRDIiID09ICJUUlVFIiBdIHx8IFsgIiRVUERBVEVfRklFTEQyIiA9PSAidHJ1ZSIgXSAgfHwgWyAiJFVQREFURV9GSUVMRDIiID09ICJUcnVlIiBdIHx8IFsgIiRVUERBVEVfRklFTEQyIiA9PSAiWUVTIiBdIHx8IFsgIiRVUERBVEVfRklFTEQyIiA9PSAieWVzIiBdICB8fCBbICIkVVBEQVRFX0ZJRUxEMiIgPT0gIlllcyIgXSB8fCBbICIkVVBEQVRFX0ZJRUxEMiIgPT0gIkZBTFNFIiBdIHx8IFsgIiRVUERBVEVfRklFTEQyIiA9PSAiZmFsc2UiIF0gfHwgWyAiJFVQREFURV9GSUVMRDIiID09ICJGYWxzZSIgXSAgfHwgWyAiJFVQREFURV9GSUVMRDIiID09ICJOTyIgXSB8fCBbICIkVVBEQVRFX0ZJRUxEMiIgPT0gIm5vIiBdIHx8IFsgIiRVUERBVEVfRklFTEQyIiA9PSAiTm8iIF0gOyB0aGVuCiAgICAgICAgICAgIGVjaG8gIiQyIgogICAgICAgIGVsc2UKICAgICAgICAgICAgZWNobyAiJFVQREFURV9GSUVMRDIiCiAgICAgICAgZmkKICAgIGVsc2UKICAgICAgICBlY2hvICIkMiIKICAgIGZpCn0KCiMgRnVuY3Rpb24gdG8gcGFyc2Ugc2NyaXB0IHBhcmFtZXRlciBvdmVycmlkZXMKZnVuY3Rpb24gR2V0T3ZlcnJpZGVzKCkgewogICAgVVBEQVRFX1dPUkQ9JChHZXRVcGRhdGVPdmVycmlkZSAiJE9WRVJSSURFX1dPUkQiICIkVVBEQVRFX1dPUkQiKQogICAgRGVidWcgIlJlc29sdmVkIFVQREFURV9XT1JEOiAkVVBEQVRFX1dPUkQiCiAgICBWRVJTSU9OX1dPUkQ9JChHZXRWZXJzaW9uT3ZlcnJpZGUgIiRPVkVSUklERV9XT1JEIiAiJFZFUlNJT05fV09SRCIpCiAgICBEZWJ1ZyAiUmVzb2x2ZWQgVkVSU0lPTl9XT1JEOiAkVkVSU0lPTl9XT1JEIgoKICAgIFVQREFURV9FWENFTD0kKEdldFVwZGF0ZU92ZXJyaWRlICIkT1ZFUlJJREVfRVhDRUwiICIkVVBEQVRFX0VYQ0VMIikKICAgIERlYnVnICJSZXNvbHZlZCBVUERBVEVfRVhDRUw6ICRVUERBVEVfRVhDRUwiCiAgICBWRVJTSU9OX0VYQ0VMPSQoR2V0VmVyc2lvbk92ZXJyaWRlICIkT1ZFUlJJREVfRVhDRUwiICIkVkVSU0lPTl9FWENFTCIpCiAgICBEZWJ1ZyAiUmVzb2x2ZWQgVkVSU0lPTl9FWENFTDogJFZFUlNJT05fRVhDRUwiCgogICAgVVBEQVRFX1BPV0VSUE9JTlQ9JChHZXRVcGRhdGVPdmVycmlkZSAiJE9WRVJSSURFX1BPV0VSUE9JTlQiICIkVVBEQVRFX1BPV0VSUE9JTlQiKQogICAgRGVidWcgIlJlc29sdmVkIFVQREFURV9QT1dFUlBPSU5UOiAkVVBEQVRFX1BPV0VSUE9JTlQiCiAgICBWRVJTSU9OX1BPV0VSUE9JTlQ9JChHZXRWZXJzaW9uT3ZlcnJpZGUgIiRPVkVSUklERV9QT1dFUlBPSU5UIiAiJFZFUlNJT05fUE9XRVJQT0lOVCIpCiAgICBEZWJ1ZyAiUmVzb2x2ZWQgVkVSU0lPTl9QT1dFUlBPSU5UOiAkVkVSU0lPTl9QT1dFUlBPSU5UIgoKICAgIFVQREFURV9PVVRMT09LPSQoR2V0VXBkYXRlT3ZlcnJpZGUgIiRPVkVSUklERV9PVVRMT09LIiAiJFVQREFURV9PVVRMT09LIikKICAgIERlYnVnICJSZXNvbHZlZCBVUERBVEVfT1VUTE9PSzogJFVQREFURV9PVVRMT09LIgogICAgVkVSU0lPTl9PVVRMT09LPSQoR2V0VmVyc2lvbk92ZXJyaWRlICIkT1ZFUlJJREVfT1VUTE9PSyIgIiRWRVJTSU9OX09VVExPT0siKQogICAgRGVidWcgIlJlc29sdmVkIFZFUlNJT05fT1VUTE9PSzogJFZFUlNJT05fT1VUTE9PSyIKCiAgICBVUERBVEVfU0tZUEVCVVNJTkVTUz0kKEdldFVwZGF0ZU92ZXJyaWRlICIkT1ZFUlJJREVfU0tZUEVCVVNJTkVTUyIgIiRVUERBVEVfU0tZUEVCVVNJTkVTUyIpCiAgICBEZWJ1ZyAiUmVzb2x2ZWQgVVBEQVRFX1NLWVBFQlVTSU5FU1M6ICRVUERBVEVfU0tZUEVCVVNJTkVTUyIKICAgIFZFUlNJT05fU0tZUEVCVVNJTkVTUz0kKEdldFZlcnNpb25PdmVycmlkZSAiJE9WRVJSSURFX1NLWVBFQlVTSU5FU1MiICIkVkVSU0lPTl9TS1lQRUJVU0lORVNTIikKICAgIERlYnVnICJSZXNvbHZlZCBWRVJTSU9OX1NLWVBFQlVTSU5FU1M6ICRWRVJTSU9OX1NLWVBFQlVTSU5FU1MiCgogICAgVVBEQVRFX09ORU5PVEU9JChHZXRVcGRhdGVPdmVycmlkZSAiJE9WRVJSSURFX09ORU5PVEUiICIkVVBEQVRFX09ORU5PVEUiKQogICAgRGVidWcgIlJlc29sdmVkIFVQREFURV9PTkVOT1RFOiAkVVBEQVRFX09ORU5PVEUiCiAgICBWRVJTSU9OX09ORU5PVEU9JChHZXRWZXJzaW9uT3ZlcnJpZGUgIiRPVkVSUklERV9PTkVOT1RFIiAiJFZFUlNJT05fT05FTk9URSIpCiAgICBEZWJ1ZyAiUmVzb2x2ZWQgVkVSU0lPTl9PTkVOT1RFOiAkVkVSU0lPTl9PTkVOT1RFIgoKICAgIFVQREFURV9SRU1PVEVERVNLVE9QPSQoR2V0VXBkYXRlT3ZlcnJpZGUgIiRPVkVSUklERV9SRU1PVEVERVNLVE9QIiAiJFVQREFURV9SRU1PVEVERVNLVE9QIikKICAgIERlYnVnICJSZXNvbHZlZCBVUERBVEVfUkVNT1RFREVTS1RPUDogJFVQREFURV9SRU1PVEVERVNLVE9QIgogICAgVkVSU0lPTl9SRU1PVEVERVNLVE9QPSQoR2V0VmVyc2lvbk92ZXJyaWRlICIkT1ZFUlJJREVfUkVNT1RFREVTS1RPUCIgIiRWRVJTSU9OX1JFTU9URURFU0tUT1AiKQogICAgRGVidWcgIlJlc29sdmVkIFZFUlNJT05fUkVNT1RFREVTS1RPUDogJFZFUlNJT05fUkVNT1RFREVTS1RPUCIKICAgIAogICAgVVBEQVRFX1RFQU1TPSQoR2V0VXBkYXRlT3ZlcnJpZGUgIiRPVkVSUklERV9URUFNUyIgIiRVUERBVEVfVEVBTVMiKQogICAgRGVidWcgIlJlc29sdmVkIFVQREFURV9URUFNUzogJFVQREFURV9URUFNUyIKICAgIFZFUlNJT05fVEVBTVM9JChHZXRWZXJzaW9uT3ZlcnJpZGUgIiRPVkVSUklERV9URUFNUyIgIiRWRVJTSU9OX1RFQU1TIikKICAgIERlYnVnICJSZXNvbHZlZCBWRVJTSU9OX1RFQU1TOiAkVkVSU0lPTl9URUFNUyIKICAgIAogICAgVVBEQVRFX09ORURSSVZFPSQoR2V0VXBkYXRlT3ZlcnJpZGUgIiRPVkVSUklERV9PTkVEUklWRSIgIiRVUERBVEVfT05FRFJJVkUiKQogICAgRGVidWcgIlJlc29sdmVkIFVQREFURV9PTkVEUklWRTogJFVQREFURV9PTkVEUklWRSIKICAgIFZFUlNJT05fT05FRFJJVkU9JChHZXRWZXJzaW9uT3ZlcnJpZGUgIiRPVkVSUklERV9PTkVEUklWRSIgIiRWRVJTSU9OX09ORURSSVZFIikKICAgIERlYnVnICJSZXNvbHZlZCBWRVJTSU9OX09ORURSSVZFOiAkVkVSU0lPTl9PTkVEUklWRSIKICAgIAogICAgVVBEQVRFX01BVT0kKEdldFVwZGF0ZU92ZXJyaWRlICIkT1ZFUlJJREVfTUFVIiAiJFVQREFURV9NQVUiKQogICAgRGVidWcgIlJlc29sdmVkIFVQREFURV9NQVU6ICRVUERBVEVfTUFVIgogICAgVkVSU0lPTl9NQVU9JChHZXRWZXJzaW9uT3ZlcnJpZGUgIiRPVkVSUklERV9NQVUiICIkVkVSU0lPTl9NQVUiKQogICAgRGVidWcgIlJlc29sdmVkIFZFUlNJT05fTUFVOiAkVkVSU0lPTl9NQVUiCn0KCiMgRnVuY3Rpb24gdG8gY2hlY2sgd2hldGhlciBNQVUgMy4xOCBvciBsYXRlciBjb21tYW5kLWxpbmUgdXBkYXRlcyBhcmUgYXZhaWxhYmxlCmZ1bmN0aW9uIENoZWNrTUFVSW5zdGFsbCgpIHsKICAgIGlmIFsgISAtZSAiL0xpYnJhcnkvQXBwbGljYXRpb24gU3VwcG9ydC9NaWNyb3NvZnQvTUFVMi4wL01pY3Jvc29mdCBBdXRvVXBkYXRlLmFwcC9Db250ZW50cy9NYWNPUy9tc3VwZGF0ZSIgXTsgdGhlbgogICAgICAgIGVjaG8gIk1BVSAzLjE4IG9yIGxhdGVyIGlzIHJlcXVpcmVkISIKICAgICAgICBleGl0IDEKICAgIGZpCn0KCiMgRnVuY3Rpb24gdG8gY2hlY2sgd2hldGhlciBPZmZpY2UgYXBwcyBhcmUgaW5zdGFsbGVkCmZ1bmN0aW9uIENoZWNrQXBwSW5zdGFsbCgpIHsKICAgIGlmIFsgISAtZSAiJFBBVEhfV09SRCIgXTsgdGhlbgogICAgICAgIERlYnVnICJXb3JkIGlzIG5vdCBpbnN0YWxsZWQiCiAgICAgICAgVVBEQVRFX1dPUkQ9ImZhbHNlIgogICAgZmkKICAgIGlmIFsgISAtZSAiJFBBVEhfRVhDRUwiIF07IHRoZW4KICAgICAgICBEZWJ1ZyAiRXhjZWwgaXMgbm90IGluc3RhbGxlZCIKICAgICAgICBVUERBVEVfRVhDRUw9ImZhbHNlIgogICAgZmkKICAgIGlmIFsgISAtZSAiJFBBVEhfUE9XRVJQT0lOVCIgXTsgdGhlbgogICAgICAgIERlYnVnICJQb3dlclBvaW50IGlzIG5vdCBpbnN0YWxsZWQiCiAgICAgICAgVVBEQVRFX1BPV0VSUE9JTlQ9ImZhbHNlIgogICAgZmkKICAgIGlmIFsgISAtZSAiJFBBVEhfT1VUTE9PSyIgXTsgdGhlbgogICAgICAgIERlYnVnICJPdXRsb29rIGlzIG5vdCBpbnN0YWxsZWQiCiAgICAgICAgVVBEQVRFX09VVExPT0s9ImZhbHNlIgogICAgZmkKICAgIGlmIFsgISAtZSAiJFBBVEhfT05FTk9URSIgXTsgdGhlbgogICAgICAgIERlYnVnICJPbmVOb3RlIGlzIG5vdCBpbnN0YWxsZWQiCiAgICAgICAgVVBEQVRFX09ORU5PVEU9ImZhbHNlIgogICAgZmkKICAgIGlmIFsgISAtZSAiJFBBVEhfU0tZUEVCVVNJTkVTUyIgXTsgdGhlbgogICAgICAgIERlYnVnICJTa3lwZSBmb3IgQnVzaW5lc3MgaXMgbm90IGluc3RhbGxlZCIKICAgICAgICBVUERBVEVfU0tZUEVCVVNJTkVTUz0iZmFsc2UiCiAgICBmaQogICAgaWYgWyAhIC1lICIkUEFUSF9SRU1PVEVERVNLVE9QIiBdOyB0aGVuCiAgICAgICAgRGVidWcgIlJlbW90ZSBEZXNrdG9wIGlzIG5vdCBpbnN0YWxsZWQiCiAgICAgICAgVVBEQVRFX1JFTU9URURFU0tUT1A9ImZhbHNlIgogICAgZmkKICAgIGlmIFsgISAtZSAiJFBBVEhfQ09NUEFOWVBPUlRBTCIgXTsgdGhlbgogICAgICAgIERlYnVnICJDb21wYW55IFBvcnRhbCBpcyBub3QgaW5zdGFsbGVkIgogICAgICAgIFVQREFURV9DT01QQU5ZUE9SVEFMPSJmYWxzZSIKICAgIGZpCiAgICBpZiBbICEgLWUgIiRQQVRIX1RFQU1TIiBdOyB0aGVuCiAgICAgICAgRGVidWcgIlRlYW1zIGlzIG5vdCBpbnN0YWxsZWQiCiAgICAgICAgVVBEQVRFX1RFQU1TPSJmYWxzZSIKICAgIGZpCiAgICBpZiBbICEgLWUgIiRQQVRIX09ORURSSVZFIiBdOyB0aGVuCiAgICAgICAgRGVidWcgIk9uZURyaXZlIGlzIG5vdCBpbnN0YWxsZWQiCiAgICAgICAgVVBEQVRFX09ORURSSVZFPSJmYWxzZSIKICAgIGZpCiAgICBpZiBbICEgLWUgIiRQQVRIX01BVSIgXTsgdGhlbgogICAgICAgIERlYnVnICJNQVUgaXMgbm90IGluc3RhbGxlZCIKICAgICAgICBVUERBVEVfTUFVPSJmYWxzZSIKICAgIGZpCiAgICAKfQoKIyBGdW5jdGlvbiB0byBkZXRlcm1pbmUgdGhlIGxvZ2dlZC1pbiBzdGF0ZSBvZiB0aGUgTWFjCmZ1bmN0aW9uIERldGVybWluZUxvZ2luU3RhdGUoKSB7CiAgICAjIFRoZSBmb2xsb3dpbmcgbGluZSBpcyBjb3VydGVzeSBvZiBAbWFjbXVsZSAtIGh0dHBzOi8vbWFjbXVsZS5jb20vMjAxNC8xMS8xOS9ob3ctdG8tZ2V0LXRoZS1jdXJyZW50bHktbG9nZ2VkLWluLXVzZXItaW4tYS1tb3JlLWFwcGxlLWFwcHJvdmVkLXdheS8KICAgIENPTlNPTEU9JCgvdXNyL2Jpbi9weXRob24gLWMgJ2Zyb20gU3lzdGVtQ29uZmlndXJhdGlvbiBpbXBvcnQgU0NEeW5hbWljU3RvcmVDb3B5Q29uc29sZVVzZXI7IGltcG9ydCBzeXM7IHVzZXJuYW1lID0gKFNDRHluYW1pY1N0b3JlQ29weUNvbnNvbGVVc2VyKE5vbmUsIE5vbmUsIE5vbmUpIG9yIFtOb25lXSlbMF07IHVzZXJuYW1lID0gW3VzZXJuYW1lLCIiXVt1c2VybmFtZSBpbiBbdSJsb2dpbndpbmRvdyIsIE5vbmUsIHUiIl1dOyBzeXMuc3Rkb3V0LndyaXRlKHVzZXJuYW1lICsgIlxuIik7JykKICAgIGlmIFsgIiRDT05TT0xFIiA9PSAiIiBdOyB0aGVuCiAgICAgICAgZWNobyAiTm8gdXNlciBsb2dnZWQgaW4iCiAgICAgICAgQ01EX1BSRUZJWD0iIgogICAgZWxzZQogICAgICAgIGVjaG8gIlVzZXIgJENPTlNPTEUgaXMgbG9nZ2VkIGluIgogICAgICAgIENNRF9QUkVGSVg9InN1ZG8gLXUgJENPTlNPTEUgIgogICAgZmkKICAgIERlYnVnICJSZXNvbHZlZCBDTURfUFJFRklYOiAkQ01EX1BSRUZJWCIKfQoKIyBGdW5jdGlvbiB0byBzZXQgdGFyZ2V0IHZlcnNpb24gZm9yIGFwcApmdW5jdGlvbiBTZXRUYXJnZXRWZXJzaW9uKCkgewogICAgaWYgWyAiJDEiID09ICJMQVRFU1QiIF0gfHwgWyAiJDEiID09ICJsYXRlc3QiIF0gfHwgWyAiJDEiID09ICIiIF07IHRoZW4KICAgICAgICBUQVJHRVRfVkVSU0lPTj0iIgogICAgZWxzZQogICAgICAgIFRBUkdFVF9WRVJTSU9OPSItLXZlcnNpb24gJHsxfSIKICAgIGZpCiAgICBEZWJ1ZyAiRmluYWwgVEFSR0VUX1ZFUlNJT046ICRUQVJHRVRfVkVSU0lPTiIKfQoKIyBGdW5jdGlvbiB0byByZWdpc3RlciBhbiBhcHBsaWNhdGlvbiB3aXRoIE1BVQpmdW5jdGlvbiBSZWdpc3RlckFwcCgpIHsKICAgIERlYnVnICJSZWdpc3RlckFwcDogUGFyYW1zIC0gJDEgJDIiCiAgICAkKCR7Q01EX1BSRUZJWH1kZWZhdWx0cyB3cml0ZSBjb20ubWljcm9zb2Z0LmF1dG91cGRhdGUyIEFwcGxpY2F0aW9ucyAtZGljdC1hZGQgIiQxIiAieyAnQXBwbGljYXRpb24gSUQnID0gJyQyJzsgTENJRCA9IDEwMzMgOyB9IikKfQoKIyBGdW5jdGlvbiB0byBjYWxsICdtc3VwZGF0ZScgYW5kIHVwZGF0ZSB0aGUgdGFyZ2V0IGFwcGxpY2F0aW9uCmZ1bmN0aW9uIFBlcmZvcm1VcGRhdGUoKSB7CiAgICBEZWJ1ZyAiUGVyZm9ybVVwZGF0ZTogJHtDTURfUFJFRklYfS9MaWJyYXJ5L0FwcGxpY2F0aW9uXCBTdXBwb3J0L01pY3Jvc29mdC9NQVUyLjAvTWljcm9zb2Z0XCBBdXRvVXBkYXRlLmFwcC9Db250ZW50cy9NYWNPUy9tc3VwZGF0ZSAtLWluc3RhbGwgLS1hcHBzICQxICQyIC0td2FpdCA2MDAgMj4vZGV2L251bGwiCiAgICAke0NNRF9QUkVGSVh9L0xpYnJhcnkvQXBwbGljYXRpb25cIFN1cHBvcnQvTWljcm9zb2Z0L01BVTIuMC9NaWNyb3NvZnRcIEF1dG9VcGRhdGUuYXBwL0NvbnRlbnRzL01hY09TL21zdXBkYXRlIC0taW5zdGFsbCAtLWFwcHMgJDEgJDIgLS13YWl0IDYwMCAyPi9kZXYvbnVsbAp9CgojIyBNQUlOCkNoZWNrTUFVSW5zdGFsbApHZXRPdmVycmlkZXMKQ2hlY2tBcHBJbnN0YWxsCkRldGVybWluZUxvZ2luU3RhdGUKCmlmIFsgIiRVUERBVEVfV09SRCIgPT0gInRydWUiIF07IHRoZW4KICAgIERlYnVnICJHb2luZyBmb3IgV29yZCB1cGRhdGUiCiAgICBSZWdpc3RlckFwcCAiJFBBVEhfV09SRCIgIk1TV0QyMDE5IgogICAgU2V0VGFyZ2V0VmVyc2lvbiAiJFZFUlNJT05fV09SRCIKICAgIFBlcmZvcm1VcGRhdGUgIk1TV0QyMDE5IiAiJFRBUkdFVF9WRVJTSU9OIgplbHNlCiAgICBEZWJ1ZyAiVXBkYXRlIGZvciBXb3JkIGRpc2FibGVkIgpmaQppZiBbICIkVVBEQVRFX0VYQ0VMIiA9PSAidHJ1ZSIgXTsgdGhlbgogICAgRGVidWcgIkdvaW5nIGZvciBFeGNlbCB1cGRhdGUiCiAgICBSZWdpc3RlckFwcCAiJFBBVEhfRVhDRUwiICJYQ0VMMjAxOSIKICAgIFNldFRhcmdldFZlcnNpb24gIiRWRVJTSU9OX0VYQ0VMIgogICAgUGVyZm9ybVVwZGF0ZSAiWENFTDIwMTkiICIkVEFSR0VUX1ZFUlNJT04iCmVsc2UKICAgIERlYnVnICJVcGRhdGUgZm9yIEV4Y2VsIGRpc2FibGVkIgpmaQppZiBbICIkVVBEQVRFX1BPV0VSUE9JTlQiID09ICJ0cnVlIiBdOyB0aGVuCiAgICBEZWJ1ZyAiR29pbmcgZm9yIFBvd2VyUG9pbnQgdXBkYXRlIgogICAgUmVnaXN0ZXJBcHAgIiRQQVRIX1BPV0VSUE9JTlQiICJQUFQzMjAxOSIKICAgIFNldFRhcmdldFZlcnNpb24gIiRWRVJTSU9OX1BPV0VSUE9JTlQiCiAgICBQZXJmb3JtVXBkYXRlICJQUFQzMjAxOSIgIiRUQVJHRVRfVkVSU0lPTiIKZWxzZQogICAgRGVidWcgIlVwZGF0ZSBmb3IgUG93ZXJQb2ludCBkaXNhYmxlZCIKZmkKaWYgWyAiJFVQREFURV9PVVRMT09LIiA9PSAidHJ1ZSIgXTsgdGhlbgogICAgRGVidWcgIkdvaW5nIGZvciBPdXRsb29rIHVwZGF0ZSIKICAgIFJlZ2lzdGVyQXBwICIkUEFUSF9PVVRMT09LIiAiT1BJTTIwMTkiCiAgICBTZXRUYXJnZXRWZXJzaW9uICIkVkVSU0lPTl9PVVRMT09LIgogICAgUGVyZm9ybVVwZGF0ZSAiT1BJTTIwMTkiICIkVEFSR0VUX1ZFUlNJT04iCmVsc2UKICAgIERlYnVnICJVcGRhdGUgZm9yIE91dGxvb2sgZGlzYWJsZWQiCmZpCmlmIFsgIiRVUERBVEVfT05FTk9URSIgPT0gInRydWUiIF07IHRoZW4KICAgIERlYnVnICJHb2luZyBmb3IgT25lTm90ZSB1cGRhdGUiCiAgICBSZWdpc3RlckFwcCAiJFBBVEhfT05FTk9URSIgIk9OTUMyMDE5IgogICAgU2V0VGFyZ2V0VmVyc2lvbiAiJFZFUlNJT05fT05FTk9URSIKICAgIFBlcmZvcm1VcGRhdGUgIk9OTUMyMDE5IiAiJFRBUkdFVF9WRVJTSU9OIgplbHNlCiAgICBEZWJ1ZyAiVXBkYXRlIGZvciBPbmVOb3RlIGRpc2FibGVkIgpmaQppZiBbICIkVVBEQVRFX1NLWVBFQlVTSU5FU1MiID09ICJ0cnVlIiBdOyB0aGVuCiAgICBEZWJ1ZyAiR29pbmcgZm9yIFNmQiB1cGRhdGUiCiAgICBSZWdpc3RlckFwcCAiJFBBVEhfU0tZUEVCVVNJTkVTUyIgIk1TRkIxNiIKICAgIFNldFRhcmdldFZlcnNpb24gIiRWRVJTSU9OX1NLWVBFQlVTSU5FU1MiCiAgICBQZXJmb3JtVXBkYXRlICJNU0ZCMTYiICIkVEFSR0VUX1ZFUlNJT04iCmVsc2UKICAgIERlYnVnICJVcGRhdGUgZm9yIFNmQiBkaXNhYmxlZCIKZmkKaWYgWyAiJFVQREFURV9SRU1PVEVERVNLVE9QIiA9PSAidHJ1ZSIgXTsgdGhlbgogICAgRGVidWcgIkdvaW5nIGZvciBSZW1vdGUgRGVza3RvcCB1cGRhdGUiCiAgICBSZWdpc3RlckFwcCAiJFBBVEhfUkVNT1RFREVTS1RPUCIgIk1TUkQxMCIKICAgIFNldFRhcmdldFZlcnNpb24gIiRWRVJTSU9OX1JFTU9URURFU0tUT1AiCiAgICBQZXJmb3JtVXBkYXRlICJNU1JEMTAiICIkVEFSR0VUX1ZFUlNJT04iCmVsc2UKICAgIERlYnVnICJVcGRhdGUgZm9yIFJlbW90ZSBEZXNrdG9wIGRpc2FibGVkIgpmaQppZiBbICIkVVBEQVRFX0NPTVBBTllQT1JUQUwiID09ICJ0cnVlIiBdOyB0aGVuCiAgICBEZWJ1ZyAiR29pbmcgZm9yIENvbXBhbnkgUG9ydGFsIHVwZGF0ZSIKICAgIFJlZ2lzdGVyQXBwICIkUEFUSF9DT01QQU5ZUE9SVEFMIiAiSU1DUDAxIgogICAgU2V0VGFyZ2V0VmVyc2lvbiAiJFZFUlNJT05fQ09NUEFOWVBPUlRBTCIKICAgIFBlcmZvcm1VcGRhdGUgIklNQ1AwMSIgIiRUQVJHRVRfVkVSU0lPTiIKZWxzZQogICAgRGVidWcgIlVwZGF0ZSBmb3IgQ29tcGFueSBQb3J0YWwgZGlzYWJsZWQiCmZpCmlmIFsgIiRVUERBVEVfTUFVIiA9PSAidHJ1ZSIgXTsgdGhlbgogICAgRGVidWcgIkdvaW5nIGZvciBNaWNyb3NvdCBBdXRvIFVwZGF0ZXIgdXBkYXRlIgogICAgUmVnaXN0ZXJBcHAgIiRVUERBVEVfTUFVIiAiTVNhdTA0IgogICAgU2V0VGFyZ2V0VmVyc2lvbiAiJFZFUlNJT05fTUFVIgogICAgUGVyZm9ybVVwZGF0ZSAiTVNhdTA0IiAiJFRBUkdFVF9WRVJTSU9OIgplbHNlCiAgICBEZWJ1ZyAiVXBkYXRlIGZvciBNaWNyb3NvZnQgQXV0byBVcGRhdGVyIGRpc2FibGVkIgpmaQppZiBbICIkVVBEQVRFX09ORURSSVZFIiA9PSAidHJ1ZSIgXTsgdGhlbgogICAgRGVidWcgIkdvaW5nIGZvciBPbmVEcml2ZSB1cGRhdGUiCiAgICBSZWdpc3RlckFwcCAiJFBBVEhfT05FRFJJVkUiICJPTkRSMTgiCiAgICBTZXRUYXJnZXRWZXJzaW9uICIkVkVSU0lPTl9PTkVEUklWRSIKICAgIFBlcmZvcm1VcGRhdGUgIk9ORFIxOCIgIiRUQVJHRVRfVkVSU0lPTiIKZWxzZQogICAgRGVidWcgIlVwZGF0ZSBmb3IgT25lRHJpdmUgZGlzYWJsZWQiCmZpCmlmIFsgIiRVUERBVEVfVEVBTVMiID09ICJ0cnVlIiBdOyB0aGVuCiAgICBEZWJ1ZyAiR29pbmcgZm9yIFRlYW1zIHVwZGF0ZSIKICAgIFJlZ2lzdGVyQXBwICIkUEFUSF9URUFNUyIgIlRFQU0wMSIKICAgIFNldFRhcmdldFZlcnNpb24gIiRWRVJTSU9OX1RFQU1TIgogICAgUGVyZm9ybVVwZGF0ZSAiVEVBTTAxIiAiJFRBUkdFVF9WRVJTSU9OIgplbHNlCiAgICBEZWJ1ZyAiVXBkYXRlIGZvciBUZWFtcyBkaXNhYmxlZCIKZmkKCmV4aXQgMA==</script_contents_encoded>
</script>